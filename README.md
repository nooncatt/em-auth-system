# Custom Authentication & Authorization System (Test Task)

Backend-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ **Django + DRF**, —Ä–µ–∞–ª–∏–∑—É—é—â–µ–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É **–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏** –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ Django `auth`.  
–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É —Å JWT-—Ç–æ–∫–µ–Ω–∞–º–∏, –æ–±—Ä–∞–±–æ—Ç–∫—É —Ä–æ–ª–µ–π, –ø—Ä–∞–≤–∏–ª –¥–æ—Å—Ç—É–ø–∞ (RBAC) –∏ –≤—ã–¥–∞—á—É —Ä–µ—Å—É—Ä—Å–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π.

## –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- Python 3  
- Django  
- Django REST Framework  
- bcrypt ‚Äî —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π  
- PyJWT ‚Äî —Ç–æ–∫–µ–Ω—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏  
- PostgreSQL

## –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

- **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:** `POST /api/auth/register/`
- **–õ–æ–≥–∏–Ω (JWT):** `POST /api/auth/login/`
- **–õ–æ–≥–∞—É—Ç:** `POST /api/auth/logout/`  
- **–¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:**  
  - `GET /api/me/` ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ–±–µ  
  - `PATCH /api/me/` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è  
  - `DELETE /api/me/` ‚Äî –º—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ (`is_active = False`)

–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –≤ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ä—É—á–∫–∞—Ö ‚Äî —á–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–æ–∫:

```http
Authorization: Bearer <access_token>
```
### –°–∏—Å—Ç–µ–º–∞ —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–∞–≤ (RBAC)

–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–∞–±–ª–∏—Ü—ã:

#### Role ‚Äî –†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: `admin`, `user`, ‚Ä¶

#### BusinessElement ‚Äî –±–∏–∑–Ω–µ—Å-–æ–±—ä–µ–∫—Ç (–≤ –ø—Ä–∏–º–µ—Ä–µ: `task`)

#### AccessRule ‚Äî –ø—Ä–∞–≤–∞ —Ä–æ–ª–∏ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç:

| –ü–æ–ª–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| can_read | —á–∏—Ç–∞—Ç—å —Å–≤–æ–∏ |
| can_read_all | —á–∏—Ç–∞—Ç—å –≤—Å–µ |
| can_create | —Å–æ–∑–¥–∞–≤–∞—Ç—å |
| can_update | –æ–±–Ω–æ–≤–ª—è—Ç—å —Å–≤–æ–∏ |
| can_update_all | –æ–±–Ω–æ–≤–ª—è—Ç—å –ª—é–±—ã–µ |
| can_delete | —É–¥–∞–ª—è—Ç—å —Å–≤–æ–∏ |
| can_delete_all | —É–¥–∞–ª—è—Ç—å –ª—é–±—ã–µ |

–ü–æ–≤–µ–¥–µ–Ω–∏–µ:

- –ù–µ—Ç —Ç–æ–∫–µ–Ω–∞ ‚Üí **401 Unauthorized**  
- –ï—Å—Ç—å —Ç–æ–∫–µ–Ω, –Ω–æ –Ω–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è ‚Üí **403 Forbidden**  
- –ï—Å—Ç—å –Ω—É–∂–Ω—ã–µ –ø—Ä–∞–≤–∞ ‚Üí **200 OK**

### Mock-—Ä–µ—Å—É—Ä—Å—ã

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ mockapp —Å–æ–¥–µ—Ä–∂–∏—Ç –º–æ–¥–µ–ª—å:

#### Task: `title, description, owner, created_at, updated_at`

–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã: 

- `GET /api/tasks/ ‚Äî —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á`

–æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∑–∞–¥–∞—á–∏; —Ä–æ–ª—å —Å `can_read_all` ‚Äî –≤–∏–¥–∏—Ç –≤—Å–µ –∑–∞–¥–∞—á–∏.

- `POST /api/tasks/ ‚Äî —Å–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É (owner –ø—Ä–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –∏–∑ —Ç–æ–∫–µ–Ω–∞)`

- `GET /api/tasks/{id}/`
- `PATCH /api/tasks/{id}/`

—Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∑–∞–≤–∏—Å—è—Ç –æ—Ç –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ `can_*` –∏ `can_*_all`

–ü—Ä–∞–≤–∞ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è —á–µ—Ä–µ–∑ –∫–∞—Å—Ç–æ–º–Ω—ã–π –∫–ª–∞—Å—Å DRF-—Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π `AccessRulePermission`.

## Admin API: —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞

–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–æ–ª–∏ admin:

- `GET /api/access-rules/ ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø—Ä–∞–≤–∏–ª`
- `POST /api/access-rules/ ‚Äî —Å–æ–∑–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª–æ`
- `GET /api/access-rules/{id}/ ‚Äî –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ`
- `PATCH /api/access-rules/{id}/ ‚Äî –∏–∑–º–µ–Ω–∏—Ç—å`
- `DELETE /api/access-rules/{id}/ ‚Äî —É–¥–∞–ª–∏—Ç—å`

–¢–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –º–µ–Ω—è—Ç—å, –∫—Ç–æ –∏ –∫ –∫–∞–∫–∏–º —Ä–µ—Å—É—Ä—Å–∞–º –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø`
## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```markdown
em-auth-system/
‚îú‚îÄ config/              # Django-–ø—Ä–æ–µ–∫—Ç
‚îÇ  ‚îú‚îÄ settings.py       # –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞: –ë–î, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, DRF, middleware
‚îÇ  ‚îú‚îÄ urls.py           # –≥–ª–æ–±–∞–ª—å–Ω–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –≤—Å–µ–≥–æ API (–ø–æ–¥–∫–ª—é—á–∞–µ—Ç users –∏ mockapp)
‚îÇ  ‚îî‚îÄ middleware.py     # JWTAuthenticationMiddleware (–¥–æ—Å—Ç–∞—ë—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ —Ç–æ–∫–µ–Ω–∞)
‚îÇ
‚îú‚îÄ users/               # –≤—Å—ë –ø—Ä–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ä–æ–ª–∏
‚îÇ  ‚îú‚îÄ models.py         # User, Role, BusinessElement, AccessRule
‚îÇ  ‚îú‚îÄ serializers.py    # —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –ª–æ–≥–∏–Ω, –ø—Ä–æ—Ñ–∏–ª—å
‚îÇ  ‚îú‚îÄ views.py          
‚îÇ  ‚îú‚îÄ urls.py
‚îÇ  ‚îú‚îÄ services.py       # bcrypt + JWT (create/verify —Ç–æ–∫–µ–Ω–æ–≤)
‚îÇ  ‚îî‚îÄ permissions.py    # AccessRulePermission, IsAdminRole
‚îÇ
‚îú‚îÄ mockapp/             # demo-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –∑–∞–¥–∞—á–∞–º–∏
‚îÇ  ‚îú‚îÄ models.py         # Task
‚îÇ  ‚îú‚îÄ serializers.py
‚îÇ  ‚îú‚îÄ views.py          # —Å–ø–∏—Å–æ–∫/—Å–æ–∑–¥–∞–Ω–∏–µ/–¥–µ—Ç–∞–ª–∏ –∑–∞–¥–∞—á
‚îÇ  ‚îî‚îÄ urls.py
‚îÇ
‚îú‚îÄ requirements.txt
‚îú‚îÄ README.md
‚îî‚îÄ manage.py
```
## –°—Ö–µ–º–∞ –ë–î
```
User
‚îú‚îÄ id
‚îú‚îÄ full_name
‚îú‚îÄ email (unique)
‚îú‚îÄ password_hash
‚îú‚îÄ role_id ‚Üí Role.id
‚îú‚îÄ is_active (soft delete)
‚îî‚îÄ timestamps

Role
‚îú‚îÄ id
‚îî‚îÄ name

BusinessElement
‚îú‚îÄ id
‚îú‚îÄ code
‚îî‚îÄ name

AccessRule
‚îú‚îÄ id
‚îú‚îÄ role_id ‚Üí Role
‚îú‚îÄ element_id ‚Üí BusinessElement
‚îú‚îÄ can_read
‚îú‚îÄ can_read_all
‚îú‚îÄ can_create
‚îú‚îÄ can_update
‚îú‚îÄ can_update_all
‚îú‚îÄ can_delete
‚îî‚îÄ can_delete_all
```

## üõ† –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

```bash
git clone <repo-url>
cd em-auth-system

# —Å–æ–∑–¥–∞—Ç—å –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (–ø–æ –∂–µ–ª–∞–Ω–∏—é)

pip install -r requirements.txt
python manage.py migrate
python manage.py runserver

```
–î–∞–ª–µ–µ –º–æ–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å API —á–µ—Ä–µ–∑ Postman / HTTP-–∫–ª–∏–µ–Ω—Ç,
—Å–æ–∑–¥–∞—Ç—å —Ä–æ–ª–∏ –∏ –ø—Ä–∞–≤–∏–ª–∞ –¥–æ—Å—Ç—É–ø–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –∫–∞–∫ –º–µ–Ω—è–µ—Ç—Å—è –ø–æ–≤–µ–¥–µ–Ω–∏–µ `GET/POST /api/tasks/`
–¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –Ω–∞–±–æ—Ä–æ–≤ –ø—Ä–∞–≤.