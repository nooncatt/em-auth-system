# Custom Authentication & Authorization System (Test Task)

Backend-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ **Django + DRF**, —Ä–µ–∞–ª–∏–∑—É—é—â–µ–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É **–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏** –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ Django `auth`.  
–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É —Å JWT-—Ç–æ–∫–µ–Ω–∞–º–∏, –æ–±—Ä–∞–±–æ—Ç–∫—É —Ä–æ–ª–µ–π, –ø—Ä–∞–≤–∏–ª –¥–æ—Å—Ç—É–ø–∞ (RBAC) –∏ –≤—ã–¥–∞—á—É —Ä–µ—Å—É—Ä—Å–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π.

## –¶–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞

- –°–æ–∑–¥–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é, –ª–æ–≥–∏–Ω, –ª–æ–≥–∞—É—Ç, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –∏ –º—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ.
- –ü–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞ ‚Äî –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –≤—Å–µ—Ö –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö.
- –ü–æ—Å—Ç—Ä–æ–∏—Ç—å —Å–≤–æ—é —Å–∏—Å—Ç–µ–º—É —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–∞–≤ (RBAC): —Ä–æ–ª–∏ ‚Üí –±–∏–∑–Ω–µ—Å-—ç–ª–µ–º–µ–Ω—Ç—ã ‚Üí —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è.
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤—ã–¥–∞—á—É **401 Unauthorized** –∏ **403 Forbidden** —Å–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–∞–≤–∏–ª–∞–º.
- –°–æ–∑–¥–∞—Ç—å Mock-—Ä–µ—Å—É—Ä—Å—ã –∏ –ø–æ–∫–∞–∑–∞—Ç—å, –∫–∞–∫ —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø.
- –°–¥–µ–ª–∞—Ç—å API, —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä–æ–µ **–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä** –º–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –ø—Ä–∞–≤–∏–ª–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞.

## –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- Python 3  
- Django  
- Django REST Framework  
- bcrypt ‚Äî —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π  
- PyJWT ‚Äî —Ç–æ–∫–µ–Ω—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏  
- PostgreSQL

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Å–∏—Å—Ç–µ–º—ã

### 1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (–§–ò–û, email, –ø–∞—Ä–æ–ª—å, –ø–æ–≤—Ç–æ—Ä –ø–∞—Ä–æ–ª—è)  
- –í—Ö–æ–¥ –ø–æ email + –ø–∞—Ä–æ–ª—å  
- –í—ã–¥–∞—á–∞ JWT-—Ç–æ–∫–µ–Ω–∞  
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ `Authorization: Bearer <token>`  
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è  
- –ú—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ (`is_active = False`)  
- Logout (—É–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞)

### 2. –°–∏—Å—Ç–µ–º–∞ —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–∞–≤ (RBAC)

–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–∞–±–ª–∏—Ü—ã:

#### Role
–†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: `admin`, `manager`, `user`, `guest`, ‚Ä¶

#### BusinessElement
–≠–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: `users`, `products`, `orders`, `access_rules`

#### AccessRule
–†–∞–∑—Ä–µ—à–µ–Ω–∏—è —Ä–æ–ª–∏ –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–∞:

| –ü–æ–ª–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| can_read | —á–∏—Ç–∞—Ç—å —Å–≤–æ–∏ |
| can_read_all | —á–∏—Ç–∞—Ç—å –≤—Å–µ |
| can_create | —Å–æ–∑–¥–∞–≤–∞—Ç—å |
| can_update | –æ–±–Ω–æ–≤–ª—è—Ç—å —Å–≤–æ–∏ |
| can_update_all | –æ–±–Ω–æ–≤–ª—è—Ç—å –ª—é–±—ã–µ |
| can_delete | —É–¥–∞–ª—è—Ç—å —Å–≤–æ–∏ |
| can_delete_all | —É–¥–∞–ª—è—Ç—å –ª—é–±—ã–µ |

–ü–æ–≤–µ–¥–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã:

- –ù–µ—Ç —Ç–æ–∫–µ–Ω–∞ ‚Üí **401 Unauthorized**  
- –ï—Å—Ç—å —Ç–æ–∫–µ–Ω, –Ω–æ –Ω–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è ‚Üí **403 Forbidden**  
- –ï—Å—Ç—å –ø—Ä–∞–≤–∞ ‚Üí **200 OK**

### 3. Mock-—Ä–µ—Å—É—Ä—Å—ã

–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ñ–µ–π–∫–æ–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏–µ —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã:

- `GET /api/products/`  
- `GET /api/orders/`

–û–Ω–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ë–î ‚Äî —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∞–≤.


## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```markdown
em-auth-system/
|
|-- config/
| |-- settings.py
| |-- urls.py
| -- middleware.py
|
|-- users/
| |-- models.py
| |-- serializers.py
| |-- views.py
| |-- urls.py
| |-- services.py
| -- permissions.py
|
|-- mockapp/
| |-- views.py
| -- urls.py
|
|-- README.md
|-- requirements.txt
-- manage.py
```
## –°—Ö–µ–º–∞ –ë–î
```
User
‚îú‚îÄ id
‚îú‚îÄ full_name
‚îú‚îÄ email (unique)
‚îú‚îÄ password_hash
‚îú‚îÄ role_id ‚Üí Role.id
‚îú‚îÄ is_active (soft delete)
‚îî‚îÄ timestamps

Role
‚îú‚îÄ id
‚îî‚îÄ name

BusinessElement
‚îú‚îÄ id
‚îú‚îÄ code
‚îî‚îÄ name

AccessRule
‚îú‚îÄ id
‚îú‚îÄ role_id ‚Üí Role
‚îú‚îÄ element_id ‚Üí BusinessElement
‚îú‚îÄ can_read
‚îú‚îÄ can_read_all
‚îú‚îÄ can_create
‚îú‚îÄ can_update
‚îú‚îÄ can_update_all
‚îú‚îÄ can_delete
‚îî‚îÄ can_delete_all
```
## üîë JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–¢–æ–∫–µ–Ω —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞ –∏ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è:
Authorization: Bearer <token>

–ö–∞—Å—Ç–æ–º–Ω—ã–π middleware:
- –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–æ–∫–µ–Ω  
- –¥–µ–∫–æ–¥–∏—Ä—É–µ—Ç JWT  
- –∏—â–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
- –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ `request.user`

## üõ† –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

```bash
git clone <url>
cd em-auth-system

pip install -r requirements.txt
python manage.py migrate
python manage.py runserver
```
–ü—Ä–∏–º–µ—Ä—ã –ø–æ–≤–µ–¥–µ–Ω–∏—è
```bash

–ë–µ–∑ —Ç–æ–∫–µ–Ω–∞
GET /api/products/
‚Üí 401 Unauthorized

–° —Ç–æ–∫–µ–Ω–æ–º –±–µ–∑ –ø—Ä–∞–≤
‚Üí 403 Forbidden

–° —Ç–æ–∫–µ–Ω–æ–º admin
‚Üí 200 OK
[
  {"id": 1, "name": "Product 1"},
  {"id": 2, "name": "Product 2"}
]

üõ° Admin API

–¢–æ–ª—å–∫–æ —Ä–æ–ª—å admin –º–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å:
- —Ä–æ–ª—è–º–∏
- –±–∏–∑–Ω–µ—Å-—ç–ª–µ–º–µ–Ω—Ç–∞–º–∏
- –ø—Ä–∞–≤–∏–ª–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞
```